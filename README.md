# IDEAL-PINNs: é¢å‘ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œçš„â€œç†æƒ³â€é‡‡æ ·ç­–ç•¥

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![PyTorch](https://img.shields.io/badge/PyTorch-EE4C2C.svg?style=flat&logo=pytorch)](https://pytorch.org/)
[![Status](https://img.shields.io/badge/Status-Active_Research-blue)]()

> **I**nverse-**D**ensity **E**volutionary **A**daptive **L**angevin Sampling (**IDEAL**)
> (é€†å¯†åº¦æœ—ä¹‹ä¸‡è‡ªé€‚åº”è¿›åŒ–é‡‡æ ·)

**IDEAL-PINNs** æ˜¯ä¸€ä¸ªæ—¨åœ¨åŠ é€Ÿç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œ (PINNs) æ”¶æ•›çš„æ–°å‹è‡ªé€‚åº”é‡‡æ ·æ¡†æ¶ã€‚å®ƒé€šè¿‡åœ¨**æ¢ç´¢**ï¼ˆé€šè¿‡é€†å¯†åº¦æ’æ–¥ï¼‰å’Œ**åˆ©ç”¨**ï¼ˆé€šè¿‡æœ—ä¹‹ä¸‡æ¢¯åº¦ä¸Šå‡ï¼‰ä¹‹é—´å»ºç«‹**ç†æƒ³å¹³è¡¡**ï¼Œè§£å†³äº†ä¼ ç»Ÿæ®‹å·®é‡‡æ ·æ–¹æ³•ä¸­è‡­åæ˜­è‘—çš„â€œæ¨¡æ€åç¼©â€é—®é¢˜ã€‚

---

##  IDEAL ç†è®ºæ¡†æ¶

æ ‡å‡†çš„è‡ªé€‚åº”ç­–ç•¥ï¼ˆå¦‚ RAD æˆ– RARï¼‰å¾€å¾€éš¾ä»¥ç»´æŒé‡‡æ ·åˆ†å¸ƒ $q(x)$ çš„**ä¿¡æ¯ç†µ** $\mathcal{H}(q)$ï¼Œæ˜“å—**è°±åå·® (Spectral Bias)** å½±å“ã€‚è¿™å¯¼è‡´é‡‡æ ·ç‚¹å…¨éƒ¨èšé›†åœ¨å•ä¸€çš„é«˜è¯¯å·®åŒºåŸŸï¼Œè€Œå¿½ç•¥äº†å…¶ä»–å…³é”®çš„ç‰©ç†ç‰¹å¾ã€‚

**IDEAL** é€šè¿‡æ„å»ºä¸€ä¸ªç»Ÿä¸€çš„**ä¿¡æ¯å¢ç›Š**ç›®æ ‡ï¼Œåœ¨é‡‡æ ·åˆ†å¸ƒ $q(x)$ å’Œç›®æ ‡åˆ†å¸ƒ $\pi(x)$ ä¹‹é—´å»ºç«‹åŠ¨æ€å¹³è¡¡ã€‚

### 1. ç›®æ ‡å‡½æ•°ä¸ç›®æ ‡åˆ†å¸ƒ

PINN è®­ç»ƒçš„ç›®æ ‡æ˜¯æœ€å°åŒ–å®šä¹‰åŸŸ $\Omega$ ä¸Šæ®‹å·®æŸå¤±çš„æœŸæœ›ï¼š


æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª**ç›®æ ‡é‡‡æ ·åˆ†å¸ƒ** $\pi(x)$ï¼Œå®ƒä¸ PDE æ®‹å·®çš„æŒ‡æ•°æˆæ­£æ¯”ï¼ˆå°†æ®‹å·®è§†ä¸ºèƒ½é‡ï¼‰ï¼š

```math
\pi(x) \propto \exp(\beta \cdot \mathcal{L}_{r}(x))
```

### 2. åŸºäºæœ‰æ•ˆåŠ¿èƒ½çš„æœ—ä¹‹ä¸‡åŠ¨åŠ›å­¦

æˆ‘ä»¬é‡‡ç”¨**éšæœºæ¢¯åº¦æœ—ä¹‹ä¸‡åŠ¨åŠ›å­¦ (SGLD)** æ¥æ¼”åŒ–ç²’å­ã€‚ç²’å­çš„è¿åŠ¨éµå¾ª**æœ‰æ•ˆåŠ¿èƒ½** $U_{eff}(x)$ çš„æ¢¯åº¦ï¼š

```math
d x(t)
= - \nabla U_{\mathrm{eff}}(x)\, dt
  + \sqrt{2\eta}\, dW(t)
```

å…¶ä¸­ï¼Œ**ç‰©ç†åŠ¿èƒ½**å®šä¹‰ä¸ºè´Ÿæ®‹å·®ï¼ˆå¼•å¯¼ç²’å­å‘é«˜ Loss åŒºåŸŸç§»åŠ¨ï¼‰ï¼š

```math
U_{\mathrm{phys}}(x) = -\mathcal{L}_{r}(x)
\quad\Longrightarrow\quad
-\nabla U_{\mathrm{phys}}(x)
= \nabla \mathcal{L}_{r}(x)
```

### 3. é€†å¯†åº¦æ’æ–¥åŠ¿èƒ½

ä¸ºè§£å†³æ¨¡æ€åç¼©ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªåŸºäºå½“å‰ç²’å­åˆ†å¸ƒ $q(x)$ çš„**æ’æ–¥åŠ¿èƒ½**ã€‚

æˆ‘ä»¬å°†**é€†å¯†åº¦**å¼•å…¥åŠ¿èƒ½ $U_{repulsion}$ ä¸­ï¼Œè¯¥åŠ¿èƒ½æƒ©ç½šç²’å­èšé›†ï¼š

```math
U_{\mathrm{rep}}(x)
= \lambda \cdot \log(\rho(x))
```


### 4. IDEAL è”åˆåŠ¨æ€æ–¹ç¨‹

IDEAL æ¡†æ¶é€šè¿‡å åŠ è¿™ä¸¤ç§åŠ¿èƒ½ï¼Œæ„é€ äº†ä¸€ä¸ª**è”åˆæœ‰æ•ˆåŠ¿èƒ½** ï¼š

```math
U_{\mathrm{IDEAL}}(x) = U_{\mathrm{phys}}(x) + U_{\mathrm{repulsion}}(x)
```

æœ€ç»ˆçš„ç²’å­åŠ¨æ€æ–¹ç¨‹ä¸ºï¼š

```math
dx(t)
= \underbrace{\nabla\mathcal{L}_{r}(x)\, dt}_{\text{ç‰©ç†å¸å¼•åŠ›}}
  - \underbrace{\lambda \nabla \log(\rho(x))\, dt}_{\text{å¯†åº¦æ’æ–¥åŠ›}}
  + \underbrace{\sqrt{2\eta}\, dW(t)}_{\text{éšæœºæ¢ç´¢}}
```

è¿™ä¸ªæ–¹ç¨‹ç¡®ä¿äº†ç²’å­çš„**ç¨³æ€åˆ†å¸ƒ $q^*(x)$** èƒ½å¤Ÿåœ¨æ®‹å·®å¤§çš„åŒºåŸŸèšé›†ï¼ˆç‰©ç†å¸å¼•ï¼‰ï¼ŒåŒæ—¶åˆä¿è¯äº†å¿…è¦çš„å…¨å±€å¤šæ ·æ€§ï¼ˆå¯†åº¦æ’æ–¥ï¼‰ï¼Œä»è€Œå®ç°äº†é‡‡æ ·çš„**ç†æƒ³å¹³è¡¡**ã€‚

### 5. è‡ªé€‚åº”é€‰æ‹©æœºåˆ¶ 

IDEAL çš„æ ¸å¿ƒåœ¨äºæ„å»ºäº†ä¸€ä¸ªæ¦‚ç‡é€‰æ‹©åœºï¼Œè¯¥æœºåˆ¶åœ¨ **åˆ©ç”¨ (Exploitation)â€**ä¸**æ¢ç´¢ (Exploration)** ä¹‹é—´ç»´æŒç€åŠ¨æ€å¹³è¡¡ï¼Œä»è€Œè§£å†³ **PINNs** è®­ç»ƒä¸­çš„æ¨¡æ€åç¼© (Mode Collapse) é—®é¢˜ã€‚

æˆ‘ä»¬å®šä¹‰é‡‡æ ·æ¦‚ç‡ $P(x)$ å¦‚ä¸‹ï¼š

```math
P(x) \propto \underbrace{\mathcal{L}(x)^{\alpha}}_{\text{æ®‹å·®å¸å¼• (åˆ©ç”¨)}} \cdot \underbrace{\frac{1}{\hat{\rho}_{\text{KNN}}(x) + \epsilon}}_{\text{é€†å¯†åº¦æ’æ–¥ (æ¢ç´¢)}}
```

è¯¥æ¦‚ç‡åœºç”±ä»¥ä¸‹ä¸¤ä¸ªå…³é”®åˆ†é‡å…±åŒé©±åŠ¨ï¼š

#### 1\. æ®‹å·®é©±åŠ¨ (Residual Exploitation):

  * **æœºåˆ¶**ï¼š$\mathcal{L}(x)$ ä»£è¡¨ PDE åœ¨ç‚¹ $x$ å¤„çš„ç‰©ç†æ®‹å·®ç»å¯¹å€¼ã€‚æŒ‡æ•° $\alpha$ (èšç„¦ç³»æ•°ï¼Œé€šå¸¸å– $1.5 \sim 2.0$) ç”¨äºæ§åˆ¶å¯¹é«˜è¯¯å·®åŒºåŸŸçš„æ•æ„Ÿåº¦ã€‚
  * **ç‰©ç†å«ä¹‰**ï¼šè¿™ä¸€é¡¹å®ç°äº†**éš¾ä¾‹æŒ–æ˜ (Hard Example Mining)**ã€‚ç®—æ³•ä¼šè‡ªåŠ¨èµ‹äºˆæ¿€æ³¢é”‹é¢ã€å¥‡ç‚¹æˆ–è¾¹ç•Œå±‚ç­‰é«˜è¯¯å·®åŒºåŸŸæ›´é«˜çš„æƒé‡ï¼Œå¼•å¯¼è®¡ç®—èµ„æºé›†ä¸­â€œæ”»å…‹â€æ¨¡å‹æ‹Ÿåˆæœ€å·®çš„åŒºåŸŸã€‚

#### 2\. åŸºäº KNN çš„é€†å¯†åº¦æ’æ–¥ (KNN-based Repulsion): 

ä¸ºäº†ä¿è¯æ ·æœ¬çš„å¤šæ ·æ€§ï¼Œæˆ‘ä»¬åˆ©ç”¨ **k-è¿‘é‚» (k-Nearest Neighbors)** ç®—æ³•æ„å»ºäº†ä¸€ä¸ª**æ— ç½‘æ ¼ (Mesh-free)** çš„å±€éƒ¨å¯†åº¦ä¼°è®¡é‡ $\hat{\rho}_{\text{KNN}}(x)$ï¼š

```math
\hat{\rho}_{\text{KNN}}(x) \propto \left( \frac{1}{k} \sum_{x_j \in \mathcal{N}_k(x)} \|x - x_j\|_2 \right)^{-1}
```

  * **æ— ç½‘æ ¼ç‰¹æ€§**ï¼šä¸ä¼ ç»Ÿçš„ç½‘æ ¼ç»Ÿè®¡æ–¹æ³•ä¸åŒï¼ŒåŸºäº KNN çš„å¯†åº¦ä¼°è®¡ä¸ä¾èµ–äºç©ºé—´ç¦»æ•£åŒ–ï¼Œå› æ­¤èƒ½å¤Ÿå¤©ç„¶é€‚åº”**é«˜ç»´ PDE** é—®é¢˜ï¼Œé¿å…äº†ç»´æ•°ç¾éš¾ã€‚
  * **æ’æ–¥åŠ›**ï¼šå½“ç²’å­åœ¨æŸå¤„è¿‡åº¦èšé›†æ—¶ï¼Œå…¶ $k$ ä¸ªæœ€è¿‘é‚»çš„å¹³å‡è·ç¦»å‡å°ï¼Œå¯¼è‡´ä¼°è®¡å¯†åº¦ $\hat{\rho}$ å‡é«˜ï¼Œä»è€Œæ€¥å‰§é™ä½è¯¥ç‚¹çš„é‡‡æ ·æ¦‚ç‡ $P(x)$ã€‚è¿™äº§ç”Ÿäº†ä¸€ç§â€œæ’æ–¥åŠ›â€ï¼Œè¿«ä½¿ç²’å­ç¾¤å‘ä½å¯†åº¦çš„ç¨€ç–åŒºåŸŸæ‰©æ•£ï¼Œç¡®ä¿äº†è§£åœ¨å…¨å±€èŒƒå›´å†…çš„è¦†ç›–ç‡ã€‚

**IDEAL**é€šè¿‡**è€¦åˆç‰©ç†æ®‹å·®ï¼ˆå¸å¼•åŠ›ï¼‰ä¸ KNN å¯†åº¦ï¼ˆæ’æ–¥åŠ›ï¼‰**ï¼Œèƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å¹¶é”å®šç‰©ç†ç‰¹å¾ï¼ˆå¦‚æ¿€æ³¢ï¼‰ï¼ŒåŒæ—¶åˆ©ç”¨æ’æ–¥æœºåˆ¶ä¿æŒç§ç¾¤çš„å¤šæ ·æ€§ï¼Œé˜²æ­¢æ‰€æœ‰é‡‡æ ·ç‚¹åç¼©è‡³å•ä¸€çš„å±€éƒ¨æå€¼ç‚¹ã€‚

##  æ ¸å¿ƒç‰¹æ€§

*  **è‡ªåŠ¨å¾®åˆ†é©±åŠ¨ (Auto-grad Powered)**: åˆ©ç”¨ PyTorch çš„è‡ªåŠ¨å¾®åˆ†è¿›è¡Œç²¾ç¡®ã€ä¸ç»´åº¦æ— å…³çš„æ¢¯åº¦è®¡ç®—ã€‚
*  **æ¶ˆé™¤æ¨¡æ€åç¼©**: å¼•å…¥æ’æ–¥æ€§å¯†åº¦é¡¹ï¼Œä¿è¯é‡‡æ ·å™¨èƒ½åŒæ—¶è¦†ç›–å¤šä¸ªè¯¯å·®å³°å€¼ï¼Œé˜²æ­¢â€œæŠ±å›¢â€ç°è±¡ã€‚
*  **æ—¶é—´ä¸€è‡´æ€§**: éå¸¸é€‚åˆæ±‚è§£æ—¶å˜ PDEï¼ˆå¦‚ Allen-Cahn, Navier-Stokesï¼‰ï¼Œèƒ½å¤Ÿè‡ªåŠ¨è¿½è¸ªéšæ—¶é—´ç§»åŠ¨çš„è§£ç‰¹å¾ã€‚

---

##  æ€§èƒ½è¡¨ç°

| æ–¹æ³• | æ ¸å¿ƒæœºåˆ¶ | æ”¶æ•›é€Ÿåº¦ | æ ·æœ¬å¤šæ ·æ€§ | è®¡ç®—æˆæœ¬ |
| :--- | :--- | :--- | :--- | :--- |
| **Uniform** (å‡åŒ€é‡‡æ ·) | éšæœºæ’’ç‚¹ | æ…¢ | é«˜ | ä½ |
| **RAD** (DeepXDE) | åŸºäº Loss åŠ æƒ | ä¸­ç­‰ | ä½ (æ˜“èšé›†) | ä½ |
| **RAR** (Refinement) | å¤§æ± å­è´ªå¿ƒç­›é€‰ | æ…¢ | ä¸­ç­‰ | é«˜ ($10\times$) |
| **IDEAL (Ours)** | **è¿›åŒ– + æ’æ–¥** | **æå¿«** | **é«˜ (è‡ªé€‚åº”)** | **ä¸­ç­‰** |

> ![1D Burgers by IDEAL](images/Burgers1.png)


---

## å®‰è£…ä¸ä½¿ç”¨

###  ä¾èµ–ç¯å¢ƒ
```bash
pip install numpy torch scipy matplotlib
```

## å¼•ç”¨ (Citation)

å¦‚æœæ‚¨è§‰å¾— **IDEAL-PINNs** å¯¹æ‚¨çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘å¼•ç”¨ï¼š

```bibtex
@misc{ideal_pinn_2025,
  author = {Xu Yang},
  title = {IDEAL-PINNs: Inverse-Density Evolutionary Adaptive Langevin Sampling},
  year = {2025},
  publisher = {GitHub},
  journal = {GitHub repository},
  howpublished = {\url{[https://github.com/XuYang-06/IDEAL-PINNs](https://github.com/XuYang-06/IDEAL-PINNs)}}
}
```

---


## ğŸ‘¤ ä½œè€… (Authors)

| [å¾é˜³ (Xu Yang)](https://www.google.com/search?q=https://github.com/XuYang-06) | é™ˆå®æ¶› (Chen Hongtao) | æ¨ä½³å® (Yang Jianing ) | éƒ­ç§‘æ–‡ (Guo Kewen) |
| :---: | :---: | :---: | :---: |
| *å‰æ—å¤§å­¦* | *å‰æ—å¤§å­¦* | *å‰æ—å¤§å­¦* | *å‰æ—å¤§å­¦* |
| CV, PINN, å…·èº«æ™ºèƒ½ | æ·±åº¦å­¦ä¹ , PINN | æ·±åº¦å­¦ä¹ , PINN | æ·±åº¦å­¦ä¹ , PINN |

---
